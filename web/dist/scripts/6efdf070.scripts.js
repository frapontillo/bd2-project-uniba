"use strict";var webApp=angular.module("webApp",["ui","ui.bootstrap","$strap","$strap.directives","ngCookies","ngResource"]);webApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",templateRoute:"/",controller:"MainCtrl"}).when("/struttura",{templateUrl:"views/struttura_list.html",templateRoute:"/struttura",controller:"StrutturaListPageCtrl"}).when("/struttura/new",{templateUrl:"views/struttura_new.html",templateRoute:"/struttura/new",controller:"StrutturaNewEditCtrl"}).when("/struttura/:id",{templateUrl:"views/struttura_detail.html",templateRoute:"/struttura/:id",controller:"StrutturaDetailCtrl"}).when("/struttura/:id/edit",{templateUrl:"views/struttura_edit.html",templateRoute:"/struttura/:id/edit",controller:"StrutturaNewEditCtrl"}).when("/dipendente",{templateUrl:"views/dipendente_list.html",templateRoute:"/dipendente",controller:"DipendenteListPageCtrl"}).when("/dipendente/new",{templateUrl:"views/dipendente_new.html",templateRoute:"/dipendente/new",controller:"DipendenteNewEditCtrl"}).when("/dipendente/:id",{templateUrl:"views/dipendente_detail.html",templateRoute:"/dipendente/:id",controller:"DipendenteDetailCtrl"}).when("/dipendente/:id/edit",{templateUrl:"views/dipendente_edit.html",templateRoute:"/dipendente/:id/edit",controller:"DipendenteNewEditCtrl"}).when("/attivita",{templateUrl:"views/attivita_list.html",templateRoute:"/attivita",controller:"AttivitaListPageCtrl"}).when("/attivita/new",{templateUrl:"views/attivita_new.html",templateRoute:"/attivita/new",controller:"AttivitaNewEditCtrl"}).when("/attivita/:id",{templateUrl:"views/attivita_detail.html",templateRoute:"/attivita/:id",controller:"AttivitaDetailCtrl"}).when("/attivita/:id/edit",{templateUrl:"views/attivita_edit.html",templateRoute:"/attivita/:id/edit",controller:"AttivitaNewEditCtrl"}).when("/assunzione/new",{templateUrl:"views/assunzione_new.html",templateRoute:"/assunzione/new",controller:"AssunzioneNewEditCtrl"}).when("/assunzione/:id",{templateUrl:"views/assunzione_detail.html",templateRoute:"/assunzione/:id",controller:"AssunzioneDetailCtrl"}).when("/assunzione/:id/edit",{templateUrl:"views/assunzione_edit.html",templateRoute:"/assunzione/:id/edit",controller:"AssunzioneNewEditCtrl"}).when("/login",{templateUrl:"views/login.html",templateRoute:"/login",controller:"LoginCtrl"}).when("/logout",{templateUrl:"views/logout.html",templateRoute:"/logout",controller:"LogoutCtrl"}).otherwise({redirectTo:"/"})}]),webApp.config(["$httpProvider",function(a){a.responseInterceptors.push("AppHttpInterceptor")}]),webApp.run(["$rootScope","$location","$cookieStore","$routeParams","AuthHandler","Menu",function(a,b,c,d,e,f){a.menu=new f({name:"The Mall",subtitle:"Gestione centro commerciale",description:'Applicativo per la gestione del centro commerciale "The Mall".',url:function(){return["/"]}}),a.mStrutture=new f({name:"Strutture",description:"Gestione delle strutture del centro commerciale. Puoi inserire una nuova struttura, modificarne una esistente o cancellare quelle in disuso.",url:function(){return["/struttura","/struttura/new","/struttura/"+d.id,"/struttura/"+d.id+"/edit"]},menuOrder:0}),a.mAttivita=new f({name:"Attività",description:"Gestione delle attività presenti nel centro commerciale. Puoi inserire attività, spostarle nelle diverse strutture, assegnare un manager o proprietario, ecc.",url:function(){return["/attivita","/attivita/new","/attivita/"+d.id,"/attivita/"+d.id+"/edit"]},menuOrder:1}),a.mDipendenti=new f({name:"Dipendenti",description:"Gestione dell'anagrafica dei dipendenti, con cronologia delle assunzioni. Possibilità di licenziare un dipendente da un'attività ed assumerlo in un'altra.",url:function(){return["/dipendente","/dipendente/new","/dipendente/"+d.id,"/dipendente/"+d.id+"/edit","/assunzione/new","/assunzione/"+d.id,"/assunzione/"+d.id+"/edit"]},menuOrder:2}),a.mAssunzioni=new f({name:"Assunzioni",description:"Gestione delle assunzioni dei dipendenti nelle attività.",url:function(){return["/assunzione","/assunzione/new","/assunzione/"+d.id,"/assunzione/"+d.id+"/edit"]},menuOrder:3}),a.menu.addChildren([a.mStrutture,a.mAttivita,a.mDipendenti]),a.menuSpan=function(){var b=parseInt(12/a.menu.children.length);return"span"+b},a.curUrl=function(){return b.path()};var g=c.get("authcode")||"",h=c.get("username")||"";g&&h&&(e.setAuthcode(g),a.session={authcode:g,user:{username:h}}),a.$on("$routeChangeStart",function(a,b,c){e.getAuthcode()||e.handleUnauthorized()}),a.reload=function(){$route.reload()}}]),"use strict",webApp.controller("MainCtrl",["$rootScope",function(a){a.pageTitle=""}]),"use strict",webApp.controller("AttivitaListPageCtrl",["$scope","$rootScope",function(a,b){b.pageTitle="Attività",a.newUrl=function(){return"#"+b.mAttivita.mainUrl()+"/new"},a.handleListLink=function(a){return"#"+b.mAttivita.mainUrl()+"/"+a.id}}]),webApp.controller("AttivitaListDialogCtrl",["$scope","dialog",function(a,b){a.handleListClick=function(a){b.close(a)},a.closeNoResult=function(){b.close(null)}}]),webApp.controller("AttivitaListCtrl",["$scope","$rootScope","Attivita",function(a,b,c){a.attivita={},a.cerca="",a.page=1,a.restartSearch=function(){a.page=1,a.searchPage()},a.searchPage=function(){a.searching=!0,a.attivita=(new c).query(a.cerca,a.strutturaForAttivitaList,a.page,function(){a.searching=!1})},a.selectPage=function(b){a.page=b,a.searchPage()},a.newUrl=function(){return"#"+b.mAttivita.mainUrl()+"/new"},a.restartSearch()}]),webApp.controller("AttivitaDetailCtrl",["$scope","$rootScope","$routeParams","$location","$dialog","Attivita",function(a,b,c,d,e,f){b.pageTitle="Attività",a.a=(new f).get(c.id,function(a){b.pageTitle="Attività "+a.nome}),a.attivitaForAssunzioneList=c.id,a.showDipendente=!0,a.showAttivita=!1,a.deleteEntity=function(){a.locked||a.openMessageBox()},a.editUrl=function(){return"#"+b.mAttivita.mainUrl()+"/"+c.id+"/edit"},a.newUrl=function(){return"#"+b.mAssunzioni.mainUrl()+"/new?attivita="+c.id},a.handleListLink=function(a){return"#"+b.mAssunzioni.mainUrl()+"/"+a.id},a.deleteAttivita=function(){a.alert={type:"info",msg:"Rimozione in corso..."},a.locked=!0,a.a=(new f).delete(c.id,function(b){a.goToList()},function(){a.alert={type:"error",msg:"Impossibile cancellare!"},a.locked=!1})},a.openMessageBox=function(){var b="Cancella attività",c="Sei sicuro di voler cancellare l'attività "+a.a.nome+"?",d=[{result:"cancel",label:"Annulla"},{result:"ok",label:"OK",cssClass:"btn-primary"}];e.messageBox(b,c,d).open().then(function(b){b=="ok"&&a.deleteAttivita()})},a.goToList=function(){d.path(b.mAttivita.mainUrl())}}]),webApp.controller("AttivitaNewEditCtrl",["$scope","$rootScope","$location","$dialog","Attivita","TipoAttivita",function(a,b,c,d,e,f){a.triedSave=!1,a.tipi=(new f).query(null,null,function(b){a.tipi=b}),a.boxManagerOpts={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"views/_dialog_dipendente.html",controller:"DipendenteListDialogCtrl"},a.boxStrutturaOpts={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"views/_dialog_struttura.html",controller:"StrutturaListDialogCtrl"},a.selectManager=function(){var c=d.dialog(a.boxManagerOpts);c.open().then(function(a){a&&b.$emit("gotManager",a)})},a.selectStruttura=function(){var c=d.dialog(a.boxStrutturaOpts);c.open().then(function(a){a&&b.$emit("gotStruttura",a)})},a.removeManager=function(){b.$emit("gotManager",undefined)},a.removeStruttura=function(){b.$emit("gotStruttura",undefined)},a.controlGroupStatus=function(a){if(!a)return"error"},a.goToList=function(a){c.path(b.mAttivita.mainUrl())},a.goToDetail=function(a){c.path(b.mAttivita.mainUrl()+"/"+a)},a.checkNumericOrEmpty=function(a){return!a||!isNaN(a)&&parseInt(a)==a}}]),webApp.controller("AttivitaEditCtrl",["$scope","$rootScope","$routeParams","Attivita",function(a,b,c,d){b.pageTitle="Modifica",a.locked=!0,a.alert={type:"info",msg:"Carico l'attività..."},a.a=(new d).get(c.id,function(c){b.pageTitle="Modifica "+c.nome,a.locked=!1,a.alert=null}),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.a.manager&&(delete a.a.manager.$$hashKey,delete a.a.manager["@type"]),a.a.struttura&&(delete a.a.struttura.$$hashKey,delete a.a.struttura["@type"]),a.a=(new d).put(c.id,a.a,function(){a.goToDetail(c.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToDetail(a.a.id)},b.$on("gotManager",function(b,c){a.a.manager=c}),b.$on("gotStruttura",function(b,c){a.a.struttura=c;if(!a.a.struttura||a.a.struttura.tipo.codice!="E")a.a.piano=null})}]),webApp.controller("AttivitaNewCtrl",["$scope","$rootScope","$location","Attivita","Struttura","Dipendente",function(a,b,c,d,e,f){b.pageTitle="Nuova attività",a.a=new d,c.search().struttura&&(a.a.struttura=(new e).get(c.search().struttura)),c.search().manager&&(a.a.manager=(new f).get(c.search().manager)),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.a.manager&&(delete a.a.manager.$$hashKey,delete a.a.manager["@type"]),a.a.struttura&&(delete a.a.struttura.$$hashKey,delete a.a.struttura["@type"]),a.a=(new d).post(a.a,function(){a.goToDetail(a.a.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToList()},b.$on("gotManager",function(b,c){a.a.manager=c}),b.$on("gotStruttura",function(b,c){a.a.struttura=c;if(!a.a.struttura||a.a.struttura.tipo.codice!="E")a.a.piano=null})}]),"use strict",webApp.controller("DipendenteListPageCtrl",["$scope","$rootScope",function(a,b){b.pageTitle="Dipendenti",a.newUrl=function(){return"#"+b.mDipendenti.mainUrl()+"/new"},a.handleListLink=function(a){return"#"+b.mDipendenti.mainUrl()+"/"+a.id}}]),webApp.controller("DipendenteListDialogCtrl",["$scope","dialog",function(a,b){a.handleListClick=function(a){b.close(a)},a.closeNoResult=function(){b.close(null)}}]),webApp.controller("DipendenteListCtrl",["$scope","$rootScope","Dipendente",function(a,b,c){a.dipendenti={},a.cerca="",a.page=1,a.restartSearch=function(){a.page=1,a.searchPage()},a.searchPage=function(){a.searching=!0,a.dipendenti=(new c).query(a.cerca,a.page,function(){a.searching=!1})},a.selectPage=function(b){a.page=b,a.searchPage()},a.restartSearch()}]),webApp.controller("DipendenteDetailCtrl",["$scope","$rootScope","$routeParams","$location","$dialog","Dipendente",function(a,b,c,d,e,f){b.pageTitle="Dipendente",a.d=(new f).get(c.id,function(a){b.pageTitle="Dipendente "+a.nome_cognome}),a.dipendenteForAssunzioneList=c.id,a.showDipendente=!1,a.showAttivita=!0,a.deleteEntity=function(){a.locked||a.openMessageBox()},a.editUrl=function(){return"#"+b.mDipendenti.mainUrl()+"/"+c.id+"/edit"},a.newUrl=function(){return"#"+b.mAssunzioni.mainUrl()+"/new?dipendente="+c.id},a.handleListLink=function(a){return"#"+b.mAssunzioni.mainUrl()+"/"+a.id},a.deleteDipendente=function(){a.alert={type:"info",msg:"Rimozione in corso..."},a.locked=!0,a.d=(new f).delete(c.id,function(b){a.goToList()},function(){a.alert={type:"error",msg:"Impossibile cancellare!"},a.locked=!1})},a.openMessageBox=function(){var b="Cancella dipendente",c="Sei sicuro di voler cancellare il dipendente "+a.d.cognome+" "+a.d.nome+"?",d=[{result:"cancel",label:"Annulla"},{result:"ok",label:"OK",cssClass:"btn-primary"}];e.messageBox(b,c,d).open().then(function(b){b=="ok"&&a.deleteDipendente()})},a.goToList=function(){d.path(b.mDipendenti.mainUrl())}}]),webApp.controller("DipendenteNewEditCtrl",["$scope","$rootScope","$location",function(a,b,c){a.triedSave=!1,a.sessi=["M","F"],a.controlGroupStatus=function(a){if(!a)return"error"},a.goToList=function(a){c.path(b.mDipendenti.mainUrl())},a.goToDetail=function(a){c.path(b.mDipendenti.mainUrl()+"/"+a)}}]),webApp.controller("DipendenteEditCtrl",["$scope","$rootScope","$routeParams","Dipendente",function(a,b,c,d){b.pageTitle="Modifica dipendente",a.locked=!0,a.alert={type:"info",msg:"Carico il dipendente..."},a.d=(new d).get(c.id,function(c){b.pageTitle="Modifica dipendente "+c.nome_cognome,a.d=c,a.locked=!1,a.alert=null}),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.d=(new d).put(c.id,a.d,function(){a.goToDetail(c.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToDetail(a.d.id)}}]),webApp.controller("DipendenteNewCtrl",["$scope","$rootScope","$routeParams","Dipendente",function(a,b,c,d){b.pageTitle="Nuovo dipendente",a.d=new d,a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.d=(new d).post(a.d,function(){a.goToDetail(a.d.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToList()}}]),"use strict",webApp.controller("StrutturaListPageCtrl",["$scope","$rootScope",function(a,b){b.pageTitle="Strutture",a.newUrl=function(){return"#"+b.mStrutture.mainUrl()+"/new"},a.handleListLink=function(a){return"#"+b.mStrutture.mainUrl()+"/"+a.id}}]),webApp.controller("StrutturaListDialogCtrl",["$scope","dialog",function(a,b){a.handleListClick=function(a){b.close(a)},a.closeNoResult=function(){b.close(null)}}]),webApp.controller("StrutturaListCtrl",["$scope","$rootScope","Struttura",function(a,b,c){a.strutture={},a.cerca="",a.page=1,a.restartSearch=function(){a.page=1,a.searchPage()},a.searchPage=function(){a.searching=!0,a.strutture=(new c).query(a.cerca,a.page,function(){a.searching=!1})},a.selectPage=function(b){a.page=b,a.searchPage()},a.newUrl=function(){return"#"+b.mStrutture.mainUrl()+"/new"},a.restartSearch()}]),webApp.controller("StrutturaDetailCtrl",["$scope","$rootScope","$routeParams","$location","$dialog","Struttura",function(a,b,c,d,e,f){b.pageTitle="Struttura",a.strutturaForAttivitaList=c.id,a.s=(new f).get(c.id,function(c){b.pageTitle="Struttura "+a.s.codice}),a.deleteEntity=function(){a.locked||a.openMessageBox()},a.editUrl=function(){return"#"+b.mStrutture.mainUrl()+"/"+c.id+"/edit"},a.newUrl=function(){return"#"+b.mAttivita.mainUrl()+"/new?struttura="+c.id},a.handleListLink=function(a){return"#"+b.mAttivita.mainUrl()+"/"+a.id},a.deleteStruttura=function(){a.alert={type:"info",msg:"Rimozione in corso..."},a.locked=!0,a.s=(new f).delete(c.id,function(b){a.goToList()},function(){a.alert={type:"error",msg:"Impossibile cancellare!"},a.locked=!1})},a.openMessageBox=function(){var b="Cancella struttura",c="Sei sicuro di voler cancellare la struttura "+a.s.cod+"?",d=[{result:"cancel",label:"Annulla"},{result:"ok",label:"OK",cssClass:"btn-primary"}];e.messageBox(b,c,d).open().then(function(b){b=="ok"&&a.deleteStruttura()})},a.goToList=function(){d.path(b.mStrutture.mainUrl())}}]),webApp.controller("StrutturaNewEditCtrl",["$scope","$rootScope","$location","TipoStruttura",function(a,b,c,d){a.triedSave=!1,a.tipi=(new d).query(null,null,function(b){a.tipi=b}),a.controlGroupStatus=function(b){if(!b&&a.triedSave)return"error"},a.goToList=function(a){c.path(b.mStrutture.mainUrl())},a.goToDetail=function(a){c.path(b.mStrutture.mainUrl()+"/"+a)}}]),webApp.controller("StrutturaEditCtrl",["$scope","$routeParams","$rootScope","Struttura",function(a,b,c,d){c.pageTitle="Modifica struttura",a.locked=!0,a.alert={type:"info",msg:"Carico la struttura..."},a.s=(new d).get(b.id,function(b){c.pageTitle="Modifica struttura "+a.s.codice,a.s=b,a.locked=!1,a.alert=null}),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.s=(new d).put(b.id,a.s,function(){a.goToDetail(b.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToDetail(a.s.id)}}]),webApp.controller("StrutturaNewCtrl",["$scope","$rootScope","Struttura",function(a,b,c){b.pageTitle="Nuova struttura",a.s=new c,a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.s=(new c).post(a.s,function(){a.goToDetail(a.s.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToList()}}]),"use strict",webApp.controller("AssunzioneListCtrl",["$scope","Dipendenza",function(a,b){a.assunzioni={},a.page=1,a.restartSearch=function(){a.page=1,a.searchPage()},a.searchPage=function(){a.searching=!0,a.assunzioni=(new b).query(a.dipendenteForAssunzioneList,a.attivitaForAssunzioneList,a.page,function(b){a.assunzioni=b,a.searching=!1})},a.selectPage=function(b){a.page=b,a.searchPage()},a.restartSearch()}]),webApp.controller("AssunzioneDetailCtrl",["$scope","$rootScope","$routeParams","$location","$dialog","Dipendenza",function(a,b,c,d,e,f){b.pageTitle="Assunzione",a.a=(new f).get(c.id,function(c){a.a=c,b.pageTitle="Assunzione di "+c.dipendente.nome_cognome}),a.deleteEntity=function(){a.locked||a.openMessageBox()},a.editUrl=function(){return"#"+b.mAssunzioni.mainUrl()+"/"+c.id+"/edit"},a.deleteAssunzione=function(){a.alert={type:"info",msg:"Rimozione in corso..."},a.locked=!0,(new f).delete(c.id,function(b){a.goToList()},function(){a.alert={type:"error",msg:"Impossibile cancellare!"},a.locked=!1})},a.openMessageBox=function(){var b="Cancella assunzione",c="Sei sicuro di voler cancellare l'assunzione? Il dipendente "+a.a.dipendente.cognome+" "+a.a.dipendente.nome+" non risulterà mai essere stato assunto dall'attività "+a.a.attivita.nome+".",d=[{result:"cancel",label:"Annulla"},{result:"ok",label:"OK",cssClass:"btn-primary"}];e.messageBox(b,c,d).open().then(function(b){b=="ok"&&a.deleteAssunzione()})},a.goToList=function(){d.path(b.mDipendenti.mainUrl()+"/"+a.a.dipendente.id)}}]),webApp.controller("AssunzioneNewEditCtrl",["$scope","$rootScope","$location","$dialog","Attivita","Dipendente",function(a,b,c,d,e,f){a.triedSave=!1,a.boxDipendenteOpts={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"views/_dialog_dipendente.html",controller:"DipendenteListDialogCtrl"},a.boxAttivitaOpts={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"views/_dialog_attivita.html",controller:"AttivitaListDialogCtrl"},a.selectDipendente=function(){var c=d.dialog(a.boxDipendenteOpts);c.open().then(function(a){a&&b.$emit("gotDipendente",a)})},a.selectAttivita=function(){var c=d.dialog(a.boxAttivitaOpts);c.open().then(function(a){a&&b.$emit("gotAttivita",a)})},a.controlGroupStatus=function(a){if(!a)return"error"},a.goToList=function(a){window.history.back()},a.goToDetail=function(a){c.url(b.mAssunzioni.mainUrl()+"/"+a)},a.checkNumericOrEmpty=function(a){return!a||!isNaN(a)&&parseInt(a)==a}}]),webApp.controller("AssunzioneEditCtrl",["$scope","$rootScope","$routeParams","Dipendenza",function(a,b,c,d){b.pageTitle="Modifica assunzione",a.locked=!0,a.alert={type:"info",msg:"Carico l'assunzione..."},a.canChangeDipendente=!1,a.canChangeAttivita=!1,a.a=(new d).get(c.id,function(b){a.locked=!1,a.alert=null}),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.a.dipendente&&(delete a.a.dipendente.$$hashKey,delete a.a.dipendente["@type"]),a.a.attivita&&(delete a.a.attivita.$$hashKey,delete a.a.attivita["@type"]),a.a=(new d).put(c.id,a.a,function(){a.goToDetail(c.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToDetail(a.a.id)},b.$on("gotDipendente",function(b,c){a.a.dipendente=c}),b.$on("gotAttivita",function(b,c){a.a.attivita=c})}]),webApp.controller("AssunzioneNewCtrl",["$scope","$rootScope","$location","Attivita","Dipendente","Dipendenza",function(a,b,c,d,e,f){b.pageTitle="Nuova assunzione",a.a=new f,a.canChangeDipendente=!0,a.canChangeAttivita=!0,c.search().attivita&&(a.a.attivita=(new d).get(c.search().attivita)),c.search().dipendente&&(a.a.dipendente=(new e).get(c.search().dipendente)),a.save=function(){a.locked||(a.$parent.triedSave=!0,a.alert={type:"info",msg:"Salvataggio in corso..."},a.locked=!0,a.a.dipendente&&(delete a.a.dipendente.$$hashKey,delete a.a.dipendente["@type"]),a.a.attivita&&(delete a.a.attivita.$$hashKey,delete a.a.attivita["@type"]),a.a=(new f).post(a.a,function(){a.goToDetail(a.a.id)},function(){a.locked=!1,a.alert={type:"error",msg:"Errore durante il salvataggio!"}}))},a.cancel=function(){a.locked||a.goToList()},b.$on("gotDipendente",function(b,c){a.a.dipendente=c}),b.$on("gotAttivita",function(b,c){a.a.attivita=c})}]),"use strict",webApp.controller("LoginCtrl",["$scope","$rootScope","$timeout","UserSession","AuthHandler",function(a,b,c,d,e){b.pageTitle="Login",a.trying=!1,a.alterDismiss=undefined,a.tryLogin=function(){a.trying=!0,a.alterDismiss&&c.cancel(a.alterDismiss),a.alert={type:"info",msg:"Login in corso..."},d.login(a.username,a.password,function(b){e.handleAuthorized(b.authcode,b,a.remember)},function(){a.trying=!1,a.alert={type:"error",msg:"Dati non corretti!"},a.alterDismiss=c(function(){a.alert=undefined},2e3)})}}]),"use strict",webApp.controller("LogoutCtrl",["$scope","$rootScope","$timeout","UserSession","AuthHandler",function(a,b,c,d,e){b.pageTitle="Logout",a.afterLogout=function(){a.alert={type:"success",msg:"Uscita eseguita con successo. Ridireziono alla pagina di login..."},c(function(){e.handleLogout()},1e3)},d.logout(e.getAuthcode(),a.afterLogout,a.afterLogout),a.alert={type:"info",msg:"Uscita in corso..."}}]),"use strict",webApp.factory("Menu",function(){var a=function(a){return this._name=a.name,this.name=a.name,this.subtitle=a.subtitle,this.url=a.url,this.icon=a.icon,this._description=a.description,this.description=a.description,this.menuOrder=a.menuOrder,this.children=[],this.parent=undefined,this.hash=a.hash||function(){return"#"},this.target=function(){return this.hash()!="#"?"_blank":"_self"},this.show=a.show==undefined?!0:a.show,this};return a.prototype.addChild=function(a){var b=a;return b.parent=this,this.children.push(b),b},a.prototype.addChildren=function(a){for(var b in a)this.addChild(a[b]);return this},a.prototype.isLeaf=function(){return this.children=={}||this.children.length==0},a.prototype.hasChildren=function(){return!this.isLeaf()},a.prototype.hasBrothers=function(){return this.parent!=null&&this.parent.children!=null&&this.parent.children!={}},a.prototype.hasUrl=function(a){var b=!1;return angular.forEach(this.url(),function(c){if(c==a){b=!0;return}}),b},a.prototype.mainUrl=function(){return this.url()[0]},a.prototype.isActive=function(a,b,c){var d=!1;return c=c||{t:!0,f:!1},b=b||c.f||!1,angular.forEach(this.url(),function(b){if(b==a){d=c.t||!0;return}}),!d&&!b&&angular.forEach(this.children,function(e){if(e.isActive(a,b,c)){d=c.t||!0;return}}),d},a.prototype.isDropdown=function(a){a=a||{t:!0,f:!1};if(this.hasChildren())return a.t||!0},a}),"use strict",webApp.factory("Struttura",["$resource","Config","AuthHandler",function(a,b,c){var d=a(b.baseAPI()+"struttura/:id",{},{_query:{method:"GET",params:{authcode:"",codice:"",page:"1"}},_get:{method:"GET",params:{authcode:"",id:""}},_post:{method:"POST",params:{authcode:""}},_put:{method:"PUT",params:{authcode:"",id:""}},_delete:{method:"DELETE",params:{authcode:""}}});return d.prototype.query=function(a,b,e,f){return d._query({codice:a,page:b||"1",authcode:c.getAuthcode()},function(a){d.prototype.fillAll(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.get=function(a,b,e){return d._get({id:a,authcode:c.getAuthcode()},function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.put=function(a,b,e,f){return d._put({authcode:c.getAuthcode(),id:a},b,function(a){d.prototype.fill(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.post=function(a,b,e){return d._post({authcode:c.getAuthcode()},a,function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.delete=function(a,b,e){return d._delete({authcode:c.getAuthcode(),id:a},function(a){b&&angular.isFunction(b)&&b(a)},e)},d.prototype.fill=function(a){a.cod=a.tipo.codice+"-"+a.id},d.prototype.fillAll=function(a){angular.isArray(a)||(a.list&&!angular.isArray(a.list)&&(a.list=[a.list]),a.pages&&(a.pages=parseInt(a.pages)),a.page&&(a.page=parseInt(a.page)));if(!a.list)return;for(var b in a.list)d.prototype.fill(a.list[b])},d}]),"use strict",webApp.factory("Attivita",["$resource","Config","AuthHandler",function(a,b,c){var d=a(b.baseAPI()+"attivita/:id",{},{_query:{method:"GET",params:{authcode:"",nome:"",struttura:"",page:"1"}},_get:{method:"GET",params:{authcode:"",id:""}},_post:{method:"POST",params:{authcode:""}},_put:{method:"PUT",params:{authcode:"",id:""}},_delete:{method:"DELETE",params:{authcode:""}}});return d.prototype.query=function(a,b,e,f,g){return d._query({nome:a,struttura:b||"",page:e||"1",authcode:c.getAuthcode()},function(a){d.prototype.fillAll(a),f&&angular.isFunction(f)&&f(a)},g)},d.prototype.get=function(a,b,e){return d._get({id:a,authcode:c.getAuthcode()},function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.put=function(a,b,e,f){return d._put({authcode:c.getAuthcode(),id:a},b,function(a){d.prototype.fill(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.post=function(a,b,e){return d._post({authcode:c.getAuthcode()},a,function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.delete=function(a,b,e){return d._delete({authcode:c.getAuthcode(),id:a},function(a){b&&angular.isFunction(b)&&b(a)},e)},d.prototype.fill=function(a){a.franchising=a.franchising=="true"||a.franchising==1,a.manager&&(a.manager.nome_cognome=a.manager.cognome+" "+a.manager.nome)},d.prototype.fillAll=function(a){angular.isArray(a)||(a.list&&!angular.isArray(a.list)&&(a.list=[a.list]),a.pages&&(a.pages=parseInt(a.pages)),a.page&&(a.page=parseInt(a.page)));if(!a.list)return;for(var b in a.list)d.prototype.fill(a.list[b])},d}]),"use strict",webApp.factory("Dipendente",["$resource","Config","AuthHandler",function(a,b,c){var d=a(b.baseAPI()+"dipendente/:id",{},{_query:{method:"GET",params:{authcode:"",nomecognome:"",page:"1"}},_get:{method:"GET",params:{authcode:"",id:""}},_post:{method:"POST",params:{authcode:""}},_put:{method:"PUT",params:{authcode:"",id:""}},_delete:{method:"DELETE",params:{authcode:""}}});return d.prototype.query=function(a,b,e,f){return d._query({nomecognome:a,page:b||"1",authcode:c.getAuthcode()},function(a){d.prototype.fillAll(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.get=function(a,b,e){return d._get({id:a,authcode:c.getAuthcode()},function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.put=function(a,b,e,f){return d._put({authcode:c.getAuthcode(),id:a},b,function(a){d.prototype.fill(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.post=function(a,b,e){return d._post({authcode:c.getAuthcode()},a,function(a){d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.delete=function(a,b,e){return d._delete({authcode:c.getAuthcode(),id:a},function(a){b&&angular.isFunction(b)&&b(a)},e)},d.prototype.fill=function(a){a.data_nascita=moment(a.data_nascita)._d,a.nome_cognome=a.cognome+" "+a.nome},d.prototype.fillAll=function(a){angular.isArray(a)||(a.list&&!angular.isArray(a.list)&&(a.list=[a.list]),a.pages&&(a.pages=parseInt(a.pages)),a.page&&(a.page=parseInt(a.page)));if(!a.list)return;for(var b in a.list)d.prototype.fill(a.list[b])},d}]),"use strict",webApp.factory("Dipendenza",["$resource","Config","AuthHandler","Dipendente",function(a,b,c,d){var e=a(b.baseAPI()+"dipendenza/:id",{},{_query:{method:"GET",params:{authcode:"",dipendente:"",attivita:"",page:"1"}},_get:{method:"GET",params:{authcode:"",id:""}},_post:{method:"POST",params:{authcode:""}},_put:{method:"PUT",params:{authcode:"",id:""}},_delete:{method:"DELETE",params:{authcode:"",id:""}}});return e.prototype.query=function(a,b,d,f,g){return e._query({dipendente:a||"",attivita:b||"",page:d||"1",authcode:c.getAuthcode()},function(a){e.prototype.fillAll(a),f&&angular.isFunction(f)&&f(a)},g)},e.prototype.get=function(a,b,d){return e._get({id:a,authcode:c.getAuthcode()},function(a){e.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},d)},e.prototype.put=function(a,b,d,f){return e._put({authcode:c.getAuthcode(),id:a},b,function(a){e.prototype.fill(a),d&&angular.isFunction(d)&&d(a)},f)},e.prototype.post=function(a,b,d){return e._post({authcode:c.getAuthcode()},a,function(a){e.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},d)},e.prototype.delete=function(a,b,d){return e._delete({authcode:c.getAuthcode(),id:a},function(a){b&&angular.isFunction(b)&&b(a)},d)},e.prototype.fill=function(a){a.data_assunzione=a.data_assunzione?moment(a.data_assunzione)._d:undefined,a.data_licenziamento=a.data_licenziamento?moment(a.data_licenziamento)._d:undefined,(new d).fill(a.dipendente)},e.prototype.fillAll=function(a){angular.isArray(a)||(a.list&&!angular.isArray(a.list)&&(a.list=[a.list]),a.pages&&(a.pages=parseInt(a.pages)),a.page&&(a.page=parseInt(a.page)));if(!a.list)return;for(var b in a.list)e.prototype.fill(a.list[b])},e}]),"use strict",webApp.factory("TipoStruttura",["$resource","Config","AuthHandler",function(a,b,c){var d=a(b.baseAPI()+"tipostruttura/:id",{},{_query:{method:"GET",params:{authcode:"",skip:"",top:""}},_get:{method:"GET",params:{authcode:"",id:""}}});return d.prototype.query=function(a,b,e,f){return d._query({skip:a||"",top:b||"",authcode:c.getAuthcode()},function(a){a=d.prototype.fillAll(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.get=function(a,b,e){return d._get({id:a,authcode:c.getAuthcode()},function(a){a=d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.fill=function(a){return a},d.prototype.fillAll=function(a){angular.isArray(a)||a.tipoStruttura&&angular.isArray(a.tipoStruttura)&&(a=a.tipoStruttura);if(!a)return;for(var b in a)b=d.prototype.fill(a[b]);return a},d}]),"use strict",webApp.factory("TipoAttivita",["$resource","Config","AuthHandler",function(a,b,c){var d=a(b.baseAPI()+"tipoattivita/:id",{},{_query:{method:"GET",params:{authcode:"",skip:"",top:""}},_get:{method:"GET",params:{authcode:"",id:""}}});return d.prototype.query=function(a,b,e,f){return d._query({skip:a||"",top:b||"",authcode:c.getAuthcode()},function(a){a=d.prototype.fillAll(a),e&&angular.isFunction(e)&&e(a)},f)},d.prototype.get=function(a,b,e){return d._get({id:a,authcode:c.getAuthcode()},function(a){a=d.prototype.fill(a),b&&angular.isFunction(b)&&b(a)},e)},d.prototype.fill=function(a){return a},d.prototype.fillAll=function(a){angular.isArray(a)||a.tipoAttivita&&angular.isArray(a.tipoAttivita)&&(a=a.tipoAttivita);if(!a)return;for(var b in a)b=d.prototype.fill(a[b]);return a},d}]),"use strict",webApp.factory("UserSession",["$resource","Config",function(a,b){var c=a(b.baseAPI()+"usersession",{},{get:{method:"GET",params:{authcode:""}},post:{method:"POST",params:{username:"",password:""}},"delete":{method:"DELETE",params:{authcode:""}}});c.login=function(a,b,e,f){return(new c).$post({username:a,password:b},function(a){d(a),e(a)},f)},c.logout=function(a,b,d){return c.delete({authcode:a},function(a){b(a)},d)},c.prototype.fill=function(){d(this)},c.prototype.fillAll=function(a){if(!a)return;for(var b in a)d(a[b])};var d=function(a){};return c}]),"use strict",webApp.factory("Config",function(){var a="http://localhost\\:8080/rest/api/";return{baseAPI:function(){return a}}}),"use strict",webApp.factory("AuthHandler",["$cookieStore","$location","$rootScope",function(a,b,c){var d={},e="";return d.getAuthcode=function(){return e||""},d.setAuthcode=function(a){e=a},d.handleAuthorized=function(d,f,g){g&&(a.put("authcode",d),a.put("username",f.user.username)),c.session=f,e=d;var h=b.search()?b.search().return||"/":"/";h=decodeURIComponent(h),b.search({}),b.url(h),c.$emit("applicationReload")},d.handleLogout=function(){a.remove("authcode"),a.remove("username"),c.session=null,e="",b.path("/login")},d.handleUnauthorized=function(){if(b.path()!="/login"){a.remove("authcode"),a.remove("username"),e="";var c=encodeURIComponent(b.url());b.path()=="/logout"&&(c=null),b.path("/login"),c&&b.search({"return":c})}},d}]),"use strict",webApp.factory("AppHttpInterceptor",["$q","$rootScope","$location","AuthHandler",function(a,b,c,d){return function(b){return b.then(function(a){return a},function(b){return b.status==401&&d.handleUnauthorized(),a.reject(b)})}}]),"use strict",webApp.directive("onScroll",function(){return function(a,b,c){var d=b[0];b.bind("scroll",function(){d.scrollTop+d.offsetHeight>=d.scrollHeight&&a.$apply(c.onScroll)})}}),"use strict",webApp.directive("date",["dateFilter",function(a){return{require:"ngModel",link:function(b,c,d,e){var f,g,h,i,j=function(b,c){return c==a(b,g)};b.$watch(d,function(){f=b.$eval(d.date),g=f.filter,h=f.parse}),e.$parsers.unshift(function(a){var b=moment(a,h);return b&&j(b._d,a)?(e.$setValidity("date",!0),b._d):(e.$setValidity("date",!0),"")}),e.$formatters.unshift(function(b){return a(b,g)})}}}]),webApp.filter("bool",function(){return function(a,b){var c=b[0],d=b[1];return a?c:d}});